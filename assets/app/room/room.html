<div class="container-fluid">
	<div class="row">
		<div class="col-md-10 col-xs-12 no-gutter" ng-controller="MessageLogController as log">
			<ol class="list-unstyled message-list" fill auto-scroll margin-bottom="45">
				<li class="message" ng-class="{ local: message.author.id == log.user.id }" ng-switch="!!message.author"
					ng-repeat="message in log.messages track by message.id">
					<div ng-switch-when="true">
						<div class="message-author">
							<span ng-if="log.messages[$index-1].author.id != message.author.id">
								<img gravatar-src-once="message.author.email | lowercase" gravatar-size="20"/>
								<div class="name">{{message.author.nick}}</div>
                                <span class="status" ng-class="{ here: message.author.connected }"></span>
							</span>
						</div>
						<div class="message-caret" ng-if="log.messages[$index-1].author.id != message.author.id"></div>
						<div class="message-body" ng-class="{ 'new-message-body': log.messages[$index-1].author.id != message.author.id }">
							<span bunker-message="{{message.text}}">
							</span>
							<span ng-if="log.messages[$index-1].author.id != message.author.id"
								  class="message-timestamp text-muted">
								<small am-time-ago="message.createdAt" title="{{message.createdAt | date:'medium'}}"></small>
							</span>
						</div>
					</div>
					<div ng-switch-default>
						<div class="alert alert-message text-muted">
							{{message.text}}
						</div>
						<span class="message-timestamp text-muted">
							<small am-time-ago="message.createdAt" title="{{message.createdAt | date:'medium'}}">
							</small>
						</span>
					</div>
				</li>
			</ol>
		</div>
		<div class="col-md-2 hidden-sm hidden-xs no-gutter member-list">
			<ul class="list-group">
				<li class="list-group-item" ng-repeat="member in room.room.room.members | filter:{connected:true}">
					<img gravatar-src-once="member.email | lowercase" gravatar-size="20"/>
					{{member.nick}}
					<span class="status pull-right" ng-class="{ here: member.connected }"></span>
				</li>
			</ul>
		</div>
	</div>
</div>

<div class="container-fluid message-input" ng-controller="InputController as input">
	<div class="row">
		<form class="col-md-10 no-gutter" ng-submit="input.sendMessage()">
			<div class="input-group">
				<input type="text" class="form-control" ng-model="input.messageText" ng-keyup="input.keyUp($event)"
					   ng-keydown="input.keyDown($event)"/>
					<span class="input-group-btn">
						<button type="submit" class="btn btn-success">Send</button>
					</span>
			</div>
		</form>
	</div>
</div>
